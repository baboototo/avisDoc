<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    
	<title>AJ렌터카 개발 가이드</title>
	
    <link href="../resource/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">			<!-- 부트스트랩 CSS -->
    <link href="../resource/bootstrap/metisMenu/dist/metisMenu.min.css" rel="stylesheet">	<!-- 부트스트랩 메뉴 CSS -->
    <link href="../resource/bootstrap/sbAdmin2/dist/css/timeline.css" rel="stylesheet">		<!-- 부트스트랩 TimeLine CSS -->
    <link href="../resource/bootstrap/sbAdmin2/dist/css/sb-admin-2.css" rel="stylesheet">	<!-- 부트스트랩 테마 CSS -->
    <link href="../resource/bootstrap/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">	<!-- 부트스트랩 테마폰트 CSS -->
    
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body>

	<!-- 네비게이션 -->
	<nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
		
		<!-- 네비게이션 헤더 -->
		<div class="navbar-header">
		    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		    </button>
		    <a class="navbar-brand" href="./index.html"><b>AJ렌터카 개발 가이드</b></a>
		</div>
		
		<!-- 네비게이션 상단 오른쪽 드롭다운 -->
		<ul class="nav navbar-top-links navbar-right">
			<li class="dropdown" id="fileDownLoadDropdown">
			</li>
		</ul>
		
		<!-- 네비게이션 메뉴 -->
		<div class="navbar-default sidebar" role="navigation">
			<div class="sidebar-nav navbar-collapse">
				<ul class="nav" id="side-menu">
				</ul>
			</div>
		</div>
	</nav>
	
	<!-- 본문내용 -->
	<div id="page-wrapper">
		<div class="row">
			<div class="col-lg-12">
			    <h1 class="page-header">Grid 가이드</h1>
                
				<!-- Contents Start -->
                <div class="panel-group" id="accordion">
                	
                    <div class="panel panel-default">
                        
                       	<!-- Nav tabs start -->
						<ul class="nav nav-tabs">
							<li class="active">
								<a href="#tab01" data-toggle="tab">Grid Script</a>
							</li>
                               
							<li>
								<a href="#tab02" data-toggle="tab">Grid Format</a>
							</li>
                               
							<li>
								<a href="#tab03" data-toggle="tab">조회 Event</a>
							</li>
						</ul>
                       	<!-- Nav tabs end -->

						<!-- Tab panes start -->
						<div class="panel-body">
							<div class="tab-content">
								<!-- tab01 start -->
								<div class="tab-pane fade in active" id="tab01">
									<h4>Grid Script 선언</h4>
									<div class="alert alert-info">
										<p class="text-gray">
											※&nbsp;Gauce Grid Script 선언 방식을 IBSheet Script 선언으로 변경
											<br/>
											-&nbsp;Tab 형태 조회 <b>:</b> 화면구성 > JavaScript 참조
				                    	</p>
                            		</div>
									
                                    <div class="panel panel-default">
                                    	
										<!-- header start -->
				                        <div class="panel-heading">
				                        	AS-IS
				                        </div>
										<!-- header end -->
				                        
										<!-- body start -->
				                        <div class="panel-body">

											<!-- Code Start -->
											<pre class="contentsLine">
&lt;script language="javascript" src="../js/grid.js"&gt;&lt;/script&gt;
											</pre>
	                        				<!-- Code End -->
				                        </div>
										<!-- body end -->
				                    </div>
									
                                    <div class="panel panel-default">
                                    	
                                    	<!-- header start -->
				                        <div class="panel-heading">
				                            TO-BE
				                        </div>
                                    	<!-- header end -->
                                    	
				                        <div class="panel-body">
											<!-- Code Start -->
											<pre class="contentsLine">
&lt;script type="text/javascript" src="../../resources/js/commonIBSheet.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="../../resources/ibsheet/ibsheet.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="../../resources/ibsheet/ibsheetinfo.js"&gt;&lt;/script&gt;
											</pre>
				                        </div>
				                    </div>
				                    
				                    <br/>
				                    <h4>Grid 초기화 설정</h4>
									<div class="alert alert-info">
										<p class="text-gray">
											※&nbsp;변경 전에 사용하던 초기화 하는 코드 삭제
				                    	</p>
                            		</div>
                            		
                            		<div class="panel panel-default">
	                            		<!-- header start -->
				                        <div class="panel-heading">
											삭제 Function
				                        </div>
	                                   	<!-- header end -->
                            		
	                            		<div class="panel-body">
											<!-- Code Start -->
											<pre class="contentsLine">
initGrid(grdSheet01, false);
											</pre>
				                        </div>
			                        </div>
				                    
                                </div>
                                <!-- tab01 end -->
                               
                               
                               	<!-- tab02 start -->
								<div class="tab-pane" id="tab02">
									<h4>Grid Format</h4>
									<div class="alert alert-info">
										<p class="text-gray">
											※&nbsp;Gauce Grid 초기화 설정 및 Format 변경
											<br/>
											-&nbsp;IBSheet 기능 <b>:</b> IBSheet 개발가이드 문서 참조
										</p>
									</div>
									
                                    <div class="panel panel-default">
                                    	
										<!-- header start -->
				                        <div class="panel-heading">
				                        	AS-IS
				                        </div>
										<!-- header end -->
				                        
										<!-- body start -->
				                        <div class="panel-body">

											<!-- Code Start -->
											<pre class="contentsLine">
grdSheet01.DataID = "dataSet01";
grdSheet01.Format = '' + '&lt;C&gt;ID=Currow   Name="순번"     width=30    align=center    Value={String(CurRow)}    &lt;/C&gt;'
                       + '&lt;C&gt;ID=Code     Name="고객코드"  width=70    align=center    Color=Blue    Cursor=Hand &lt;/C&gt;'
                       + '&lt;C&gt;ID=Name     Name="사업자명"  width=200   align=left&lt;/C&gt;'
                       + '&lt;C&gt;ID=BusiNo   Name="사업자번호" width=100   align=center    mask="' + MASK_BIZNO + '" &lt;/C&gt;';
											</pre>
	                        				<!-- Code End -->
				                        </div>
										<!-- body end -->
				                    </div>
									
                                    <div class="panel panel-default">
                                    	
                                    	<!-- header start -->
				                        <div class="panel-heading">
				                            TO-BE
				                            <br/>
				                            <p class="text-danger">※&nbsp;중요사항</p>
				                            <p class="text-gray">
				                            	•&nbsp;Type:"Status"
				                            	<br/>
				                            	&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp; Sheet 컬럼 값을 수정 또는 입력할 경우 자동으로 상태 값이 변경
				                            	<br/><br/>
				                            	•&nbsp;SaveName:"DATA_KEY"
				                            	<br/>
				                            	&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp; 맵핑된 DataSet Row Index
				                            	<br/>
				                            	&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp; 조회된 Sheet 행을 오름차순, 내림차순 했을 경우 보여지는 
				                            	<br/>
				                            	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sheet Row Index가 아닌 DataSet의 Row Index
				                            </p>
				                            
				                        </div>
                                    	<!-- header end -->
                                    	
                                    	<!-- body start -->
				                        <div class="panel-body">
											<!-- Code Start -->
											<pre class="contentsLine">
<span class="text-primary">/** SetSheetAndDataSet(Sheet명, 맵핑 DataSet); */</span>
SetSheetAndDataSet("sheet", "dataSet01");

var cols = [
          <span class="text-primary">/** Type:"Status" - sheet 상태 값 (입력 = "I" / 수정 = "U" / 삭제 = "D" / 조회 = "") */</span>
          {Type:"Status",  SaveName:"ISTATUS",  Hidden:true}
          <span class="text-primary">/** DATA_KEY - 맵핑된 DataSet Row Index */</span>
        , {Type:"Text",    SaveName:"DATA_KEY", Hidden:true}
        , {Type:"Seq",     SaveName:"CURROW",   Width:"30",   Align:"Center",  Edit:false}
        , {Type:"Text",    SaveName:"CODE",     Width:"70",   Align:"Center",  Edit:false,  FontColor:"BLUE",  Pointer:"HAND"}
        , {Type:"Text",    SaveName:"NAME",     Width:"200",  Align:"Left",    Edit:false}
        , {Type:"Text",    SaveName:"BUSINO",   Width:"100",  Align:"Center",  Format:MASK_BIZNO,  Edit:false}
    ];

var headers = [{Text: "상태|DATA_KEY|순번|고객코드|사업자명|사업자번호", Align:"Center"}];

<span class="text-primary">/** InitIBSheet(sheet명, Columns Json 변수, 좌우 스크롤 고정 컬럼 Index, sheet 높이 고정); */</span>
// InitIBSheet(sheet, cols, headers, 5, false);      // 5번째 컬럼 좌우 스크롤 고정, sheet 높이 고정
// InitIBSheet(sheet, cols, headers, 5);             // 5번째 컬럼 좌우 스크롤 고정, sheet 높이 고정 안함
// InitIBSheet(sheet, cols, headers, null, flase);   // 컬럼 좌우 스크롤 고정 미사용, sheet 높이 고정

InitIBSheet(sheet, cols, headers);                   // 컬럼 좌우 스크롤 고정 미사용, sheet 높이 고정 안함

// 조회된 해당 컬럼에 마우스 커서(손가락 형태) 이벤트 
sheet.SetDataLinkMouse("CODE", true);

// 마지막 컬럼 넓이 고정 (사용하지 않으면 마지막 컬럼 넓이가 sheet 마지막 여백 넓이 만큼 변경)
sheet.SetExtendLastCol(0);
											</pre>
				                        </div>
                                    	<!-- body end -->
				                    </div>
                                </div>
                                <!-- tab02 end -->
                               
                               	<!-- tab03 start -->
								<div class="tab-pane fade" id="tab03">
									<h4>&nbsp;조회 Grid Event</h4>
									<div class="alert alert-info">
										<p class="text-gray">
											※&nbsp;Gauce Grid Script 이벤트 등록 방식에서 IBSheet Function 등록 방식으로 변경
										</p>
										
										<p class="text-danger">
											-&nbsp;	조회 기능이 있는 화면에서 사용 (Sheet가 없는 등록화면에서는 미사용)
											<br/>
											-&nbsp;	대소문자를 정확하게 입력 
											<br/>
										</p>
										
										<p class="text-gray">
											-&nbsp;	Event 상세 설명 <b>:</b> IBSheet 개발가이드 문서 참조
										</p>
									</div>
									
									<br/>
									<h4>&nbsp;OnClick Event</h4>
                                    <div class="panel panel-default">
                                    	
										<!-- header start -->
				                        <div class="panel-heading">
				                        	AS-IS
				                        </div>
										<!-- header end -->
				                        
										<!-- body start -->
				                        <div class="panel-body">

											<!-- Code Start -->
											<pre class="contentsLine">
&lt;script language="javascript" for="grdSheet01" event="OnClick(row, colid)"&gt;
&lt;/script&gt;
											</pre>
	                        				<!-- Code End -->
				                        </div>
										<!-- body end -->
				                    </div>
									
                                    <div class="panel panel-default">
                                    	
                                    	<!-- header start -->
				                        <div class="panel-heading">
				                            TO-BE
				                        </div>
                                    	<!-- header end -->
                                    	
                                    	<!-- body start -->
				                        <div class="panel-body">
											<!-- Code Start -->
											<pre class="contentsLine">
<span class="text-primary">/** Sheet명_OnClick() */</span>
function sheet_OnClick(Row, Col, Value){
    <span class="text-primary">/** 선택한 Row 값이 헤더행의 개수 보다 작으면 return */</span>
    if(Row < sheet.HeaderRows()) return;
    
    <span class="text-primary">/** 선택한 Column의 SaveName */</span>
    var colid = sheet.ColSaveName(Col);
}
											</pre>
				                        </div>
                                    	<!-- body end -->
                                    	
				                    </div>
									
									
									<br/>
									<h4>&nbsp;OnDblClick Event</h4>
                                    <div class="panel panel-default">
                                    	
										<!-- header start -->
				                        <div class="panel-heading">
				                        	AS-IS
				                        </div>
										<!-- header end -->
				                        
										<!-- body start -->
				                        <div class="panel-body">

											<!-- Code Start -->
											<pre class="contentsLine">
&lt;script language="javascript" for="grdSheet01" event="OnDblClick(row, colid)"&gt;
&lt;/script&gt;
											</pre>
	                        				<!-- Code End -->
				                        </div>
										<!-- body end -->
				                    </div>
									
                                    <div class="panel panel-default">
                                    	
                                    	<!-- header start -->
				                        <div class="panel-heading">
				                            TO-BE
				                        </div>
                                    	<!-- header end -->
                                    	
                                    	<!-- body start -->
				                        <div class="panel-body">
											<!-- Code Start -->
											<pre class="contentsLine">
<span class="text-primary">/** Sheet명_OnDblClick() */</span>
function sheet_OnDblClick(Row, Col, Value){
    <span class="text-primary">/** 선택한 Row 값이 헤더행의 개수 보다 작으면 return */</span>
    if(Row < sheet.HeaderRows()) return;
    
    <span class="text-primary">/** 선택한 Column의 SaveName */</span>
    var colid = sheet.ColSaveName(Col);
}

											</pre>
				                        </div>
                                    	<!-- body end -->
                                    	
				                    </div>
				                    
				                    
				                    <br/>
									<h4>&nbsp;OnLoadCompleted Event</h4>
                                    <div class="panel panel-default">
                                    	
										<!-- header start -->
				                        <div class="panel-heading">
				                        	AS-IS
				                        </div>
										<!-- header end -->
				                        
										<!-- body start -->
				                        <div class="panel-body">

											<!-- Code Start -->
											<pre class="contentsLine">
&lt;script language="javascript" for="dataSet01" event="OnLoadCompleted(rowcount)"&gt;
    printMessage("loaded", rowcount);
&lt;/script&gt;

											</pre>
	                        				<!-- Code End -->
				                        </div>
										<!-- body end -->
				                    </div>
									
                                    <div class="panel panel-default">
                                    	
                                    	<!-- header start -->
				                        <div class="panel-heading">
				                            TO-BE
				                        </div>
                                    	<!-- header end -->
                                    	
                                    	<!-- body start -->
				                        <div class="panel-body">
											<!-- Code Start -->
											<pre class="contentsLine">
<span class="text-primary">/** Sheet명_OnSearchEnd() */</span>
function sheet_OnSearchEnd(Code, Msg){
    if(Code == 0){
        <span class="text-primary">/** Sheet명_RowCount() - 조회 된 Sheet Row 총 개수 */</span>
        printMessage("loaded", sheet.RowCount());
    }
}
											</pre>
				                        </div>
                                    	<!-- body end -->
				                    </div>
				                    
				                    
				                    <br/>
									<h4>&nbsp;OnLoadStarted Event</h4>
									<p class="text-danger">※&nbsp;IBSheet API 존재하지 않는 Function (Gauce와 동일하게 사용하게 위한 별도로 구현한 Function)</p>
									
                                    <div class="panel panel-default">
                                    	
										<!-- header start -->
				                        <div class="panel-heading">
				                        	AS-IS
				                        </div>
										<!-- header end -->
				                        
										<!-- body start -->
				                        <div class="panel-body">

											<!-- Code Start -->
											<pre class="contentsLine">
&lt;script language="javascript" for="dataSet01" event="OnLoadStarted()"&gt;
    printMessage("loading");
&lt;/script&gt;
											</pre>
	                        				<!-- Code End -->
				                        </div>
										<!-- body end -->
				                    </div>
									
                                    <div class="panel panel-default">
                                    	
                                    	<!-- header start -->
				                        <div class="panel-heading">
				                            TO-BE
				                        </div>
                                    	<!-- header end -->
                                    	
                                    	<!-- body start -->
				                        <div class="panel-body">
											<!-- Code Start -->
											<pre class="contentsLine">
<span class="text-primary">/** Sheet명_OnSearchStarted() */</span>
function sheet_OnSearchStarted(){
    printMessage("loading");
}
											</pre>
				                        </div>
                                    	<!-- body end -->
				                    </div>
				                    
				                    
				                    <br/>
									<h4>&nbsp;OnUserColor Event</h4>
									<p class="text-danger">
										※&nbsp;Gauce Grid Format에서 사용되는 OnUserColor 이벤트는 화면로딩시
										<br/>
										&nbsp;&nbsp;&nbsp;&nbsp;Row, Column 상태값에 따라 Row Color, Column Color, Font Color 설정 하는 이벤트가 별도로 존재한다.
										<br/>
										&nbsp;&nbsp;&nbsp;&nbsp;하지만 IBSheet Grid 에는 이벤트 함수가 별도로 존재 하지 않는다. Gauce Grid 발생하는 이벤트 코드는
										<br/>
										&nbsp;&nbsp;&nbsp;&nbsp;OnLoadData 함수 안에서 이벤트를 구현해야 한다.
									</p>
									
                                    <div class="panel panel-default">
                                    	
										<!-- header start -->
				                        <div class="panel-heading">
				                        	AS-IS
				                        </div>
										<!-- header end -->
				                        
										<!-- body start -->
				                        <div class="panel-body">

											<!-- Code Start -->
											<pre class="contentsLine">
&lt;script language="JavaScript" for="grdSheet01" event="OnUserColor(row,eventid)"&gt;
    if(eventid == "ucolor") {
        var gubun = jsNvl(dataSet01.NameValue(row, 'USEYN'));

        if ( gubun == "Y") {
            this.ColumnProp('CUSTNAME', 'Edit') = "none";
            return "#E6E6E6";
        } else {
            this.ColumnProp('CUSTNAME', 'Edit') = "";
            return "white";
        }
    }
&lt;/script&gt;

											</pre>
	                        				<!-- Code End -->
				                        </div>
										<!-- body end -->
				                    </div>
									
                                    <div class="panel panel-default">
                                    	
                                    	<!-- header start -->
				                        <div class="panel-heading">
				                            TO-BE
				                        </div>
                                    	<!-- header end -->
                                    	
                                    	<!-- body start -->
				                        <div class="panel-body">
											<!-- Code Start -->
											<pre class="contentsLine">
<span class="text-primary">/** Sheet명_OnLoadData() */</span>
function sheet_OnLoadData(data){
    var jsonData = JSON.parse(data);
		
    if(jsonData.hasOwnProperty("Data")){
        var rowDatas = jsonData.Data;
		
        $.each(rowDatas, function(){
            // 조회된 JSON 데이터 수정 및 속성값 설정
            
            <span class="text-primary">/** USEYN의 값 */</span>
            var gubun = this.USEYN;
            
            if(gubun == "Y"){
                <span class="text-primary">/** CUSTNAME 컬럼 값 수정 불가 */</span>
                this["CUSTNAME#Edit"] = false;
                
                <span class="text-primary">/** CUSTNAME 컬럼 수정 불가 */</span>
                this["CUSTNAME#BackColor"] = "#E6E6E6";
                this["CUSTNAME#FontColor"] = "#E6E6E6";
                this["BackColor"] = "#E6E6E6";
                this["FontColor"] = "#E6E6E6";
            }else{
                this["CUSTNAME#Edit"] = true;
            }
            
            if ( gubun == "Y") {
                this.ColumnProp('CHK', 'Edit') = "none";
            return "#E6E6E6";
        } else {
            this.ColumnProp('CHK', 'Edit') = "";
            return "white";
        }
            
        });
    }
		
    return JSON.stringify(jsonData);
}
											</pre>
				                        </div>
                                    	<!-- body end -->
				                    </div>
									
                                </div>
                                <!-- tab03 end -->
                               	
                           	</div>
						</div>
						<!-- Tab panes end -->
					</div>
                </div>
                <!-- Contents End -->
                
			</div>
		</div>
	</div>
	
	<!-- JavaScript -->
    <script src="../resource/js/jquery-1.11.2.min.js"></script>
    <script src="../resource/js/common.js"></script>
    
    <script src="../resource/bootstrap/dist/js/bootstrap.min.js"></script>			<!-- 부트스트랩 JS -->
    <script src="../resource/bootstrap/metisMenu/dist/metisMenu.min.js"></script>	<!-- 부트스트랩 메뉴 JS -->
    <script src="../resource/bootstrap/sbAdmin2/dist/js/sb-admin-2.js"></script>	<!-- 부트스트랩 테마 JS -->
</body>
</html>